.container_24.top_proposals
  %h2 #{title} (#{items.count})
  .low_limit_proposals_carousel
    %ul#low_limit_proposals_list
      - items.each do |item|
        %li 
          .proposal
            %h3.title=link_to shorten(item.title, 100, 20, "»"), idea_path(item)
            .collecting
              Keräys: 
              = item.collecting_start_date.strftime("%d.%m.%Y")
              = '- '
              = item.collecting_end_date.strftime("%d.%m.%Y")
            %div{id: "proposal_bar#{item.id}", class: "bar"}
              - signatures_count = item.signatures.where(state: "signed").count
              - total_signatures = signatures_count + item.additional_signatures_count

              - favour_vote_per  = [0, (260 * (Float(total_signatures)         / 50000)).ceil].max
              - require_vote_per = [0, (260 * (Float(50000 - total_signatures) / 50000)).ceil].max
              :javascript
                var t  = Raphael("proposal_bar#{item.id}", 260, 20);
                t.rect(0, 0, #{[favour_vote_per,(300-40)].min}, 20).attr({fill: "#f0f0f0", stroke: "#fff", strokewidth: 5});
                t.rect(#{[favour_vote_per,(260-40)].min}, 0, #{require_vote_per}, 20).attr({fill: "#f0f0f0", stroke: "#fff", strokewidth: 5});
                var r  = Raphael("proposal_bar#{item.id}", 260, 20);
                r.rect(0, 0, #{[favour_vote_per,(300-40)].min}, 20).attr({fill: "#52BD00", stroke: "#fff", strokewidth: 5});
                r.rect(#{[favour_vote_per,(260-40)].min}, 0, #{require_vote_per}, 20).attr({fill: "#D2EDC7", stroke: "#fff", strokewidth: 5});
            .days_left
              #{collecting_days_left(item.collecting_end_date)}
            .votes_total
              #{total_signatures} / #{50000}